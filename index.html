<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Santiago González Correa, Usue Urruela del Piño">
    <title>JubiCalc</title>

    <style>
        body {
            display: flex; /* Asegura que el cuerpo use flex para centrar los elementos */
            justify-content: center;
            align-items: center;
            font-family: Arial, sans-serif;
            background-color: #ccc;
        }

        .container {
            padding-top: 2%;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-auto-rows: minmax(100px, auto);            
            gap: 20px;
            max-height: 80vh; /* Ajusta la altura máxima del contenedor */
            align-items: start; /* Alinea los elementos al inicio del contenedor */
        }

        .input-container {
            grid-column: 3;
            grid-row: 1;
            gap: 20px;
        }

        .result-container {
            grid-column: 2 / span 3; /* Asegura que el resultado ocupe todo el ancho del contenedor */
        }

        .coef-table {
            grid-column: 1;
            grid-row: 1 / 5;
            background-color: #f0f0f0;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .box {
            display: flex;
            background-color: #f0f0f0;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            position:relative;
        }

        input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        label {
            position: absolute;
            top: -25px; /* Ajustar la posicion del texto encima del input*/
            left: 5px; /* Ajustar la posición del texto alineado a la izquierda */
            color: #666; /* Color de texto gris para indicar que es una descripción */
            pointer-events: none; /* Evitar que el label sea clickeable */
        }

        #result {
            font-size: large;
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #fff;
        }

        button {
            grid-column: 4;
            height: 80%;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
            font-size: 16px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #007bff;
            color: white;
        }

    </style>

</head>
<body>
    <main class="container">

        <section class="coef-table">
            <table>
                <thead>
                    <tr>
                        <th>Meses</th>
                        <th>Coeficiente</th>
                    </tr>
                </thead>
                <tbody id="coefTableBody">
                    <!-- Aquí se insertarán las filas de la tabla mediante JavaScript -->
                </tbody>
            </table>
        </section>

        <section class="box input-container">
            <label for="yearInput">Años Trabajados</label>
            <input type="number" placeholder="Ejemplo: 15" min="1" max="100" step="1" id="yearInput">
        </section>
        
        <section class="box">
            <label for="mesesAdelanto">Meses de adelanto</label>
            <input id="mesesAdelanto" type="number" min="1" max="24" placeholder="Entre 1 y 24">
        </section>
        
        <button onclick="calcular()">Calcular</button>

        <section class="box result-container">
            <textarea id="result" rows="10" readonly>Resultado</textarea>
        </section>

    </main>
   
    <script>

        const coeficientes = new Map([
            [24, 9],
            [23, 8.75],
            [22, 8.55],
            [21, 8.35],
            [20, 8.05],
            [19, 7.8],
            [18, 7.5],
            [17, 7.24],
            [16, 6.84],
            [15, 6.47],
            [14, 6.17],
            [13, 5.8],
            [12, 5.38],
            [11, 4.95],
            [10, 4.55],
            [9, 4.1],
            [8, 3.67],
            [7, 3.24],
            [6, 2.84],
            [5, 2.4],
            [4, 1.98],
            [3, 1.56],
            [2, 1],
            [1, 1]
        ]);

        const diasAcumulados = new Map([
            [35, 10],
            [34, 9],
            [33, 8],
            [32, 7],
            [31, 6],
            [30, 5],
            [29, 4],
            [28, 3],
            [27, 2],
            [26, 1]
        ]);

        const diasCanosos = new Map([
            [30, 8],
            [29, 7],
            [28, 6],
            [27, 6],
            [26, 3]
        ]);

        function loadCoefTable() {
            const coefTableBody = document.getElementById('coefTableBody');
            coeficientes.forEach((coef, months) => {
                const row = document.createElement('tr');
                const cell1 = document.createElement('td');
                const cell2 = document.createElement('td');
                cell1.textContent = months;
                cell2.textContent = coef;
                row.appendChild(cell1);
                row.appendChild(cell2);
                coefTableBody.appendChild(row);
            });
        }

        function calcular() {

            const serviciosPrestados = document.getElementById('yearInput').value;
            
            const mesesInput = parseInt(document.getElementById('mesesAdelanto').value);
            const result = document.getElementById('result');

            if (!mesesInput) {
                result.textContent = 'Por favor, pon cuatos meses quieres adelantar.';
                return;
            }
            const min = 30;
            const jornadasMes = 212 / 12;
            
            let minPorAnticipacion = mesesInput * min * jornadasMes;
            // El año tiene 212 jornadas y para calcular cuantas jornadas tiene un mes divides 212 /12
            // y luego se multiplica por el mes que introducen en el input que luego se multiplica por 10 min
            // cada dia        


            if (mesesInput > 0) {

                let coeficiente;
                if(mesesInput > 24){
                    coeficiente = 9;
                }
                else{
                    coeficiente = coeficientes.get(mesesInput);
                }

                let minResultantes = minPorAnticipacion * coeficiente

                diasPorAnticipacion = Math.ceil(minResultantes / 450);
                
                let diasPorServicios;
                let diasPorCanosos;

                // Así mismo, se acumulará 1 día por cada año de servicios reconocidos a partir de 31 años y hasta un máximo de 40 años.
                
                if (serviciosPrestados < 26){    
                    diasPorServicios = 0;
                }
                else if(serviciosPrestados > 35){
                    diasPorServicios = 10;
                }
                else{
                    diasPorServicios = diasAcumulados.get(parseInt(serviciosPrestados));
                }

                // Dias a sumar de antiguedad
                if (serviciosPrestados < 26){
                    diasPorCanosos = 0;
                }
                else if (serviciosPrestados > 30){
                    diasPorCanosos = 8;
                }
                else{
                    diasPorCanosos = diasCanosos.get(parseInt(serviciosPrestados));
                }

                let diasTotales = diasPorAnticipacion + parseInt(diasPorServicios) + parseInt(diasPorCanosos);
                
                result.textContent = `
Adelantando: ${mesesInput} meses la jubilación.
Minutos por anticipación: meses adelantados X Jornadas al mes X 30 minutos al día ${mesesInput} X ${jornadasMes.toFixed(3)} X ${min} = ${minPorAnticipacion} Minutos.
Días resultantes: minutos anticipados por coeficiente entre minutos jornada ${minPorAnticipacion} X ${coeficiente} / 450 = ${diasPorAnticipacion} días.
Días por servicios prestados ${diasPorServicios} días.
Días por canosos ${diasPorCanosos} días.
TOTAL ${diasPorAnticipacion} + ${diasPorServicios} + ${diasPorCanosos} = ${diasTotales} días.`;
            } else {
                result.textContent = 'La fecha seleccionada ya ha pasado.';
            }

        }

        document.addEventListener('DOMContentLoaded', loadCoefTable);

    </script>

</body>
</html>